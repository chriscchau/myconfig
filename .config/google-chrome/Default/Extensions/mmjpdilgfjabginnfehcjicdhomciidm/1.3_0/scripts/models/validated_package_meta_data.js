Readium.Models.ValidatedPackageMetaData=Backbone.Model.extend({initialize:function(a){this.file_path=a.file_path;this.uri_obj=new URI(a.root_url);this.set("package_doc_path",this.file_path)},validate:function(){},reset:function(a){this.set(this.parse(a))},defaults:{fixed_layout:!1,apple_fixed:!1,open_to_spread:!1,cover_href:"/images/library/missing-cover-image.png",created_at:new Date,updated_at:new Date,paginate_backwards:!1},parseIbooksDisplayOptions:function(a){this.set((new Readium.Models.IbooksOptionsParser).parse(a))},
parse:function(a){return(new Readium.Models.PackageDocumentParser(this.uri_obj)).parse(a).metadata},save:function(a,b){var c=this;this.set("updated_at",new Date);Lawnchair(function(){this.save(c.toJSON(),b.success)})},resolveUri:function(a){uri=new URI(a);return uri.resolve(this.uri_obj).toString()},resolvePath:function(a){var b=this.file_path,a=a.indexOf("../")===0?a.substr(3):a,c=b.lastIndexOf("/");return b.substr(0,c)+"/"+a}});
