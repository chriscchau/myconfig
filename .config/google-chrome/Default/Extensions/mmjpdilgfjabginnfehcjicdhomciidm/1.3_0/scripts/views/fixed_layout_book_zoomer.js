Readium.Views.FixedLayoutBookZoomer=Backbone.View.extend({el:"#readium-right-content",horizontalPad:30,verticalPad:30,initialize:function(){this.zoomingModel=new Readium.Models.FixedLayoutBookZoomingModel},render:function(){this.$("#page-wrap").css(this.zoomingModel.getCSSProperties());return this},reset:function(){this.zoomingModel.setDefaults();this.render()},fitToBest:function(){var a=this.fitToWidthScale(),b=this.fitToHeightScale();a<b?this.applyScale(a):this.applyScale(b)},fitToWidth:function(){this.applyScale(this.fitToWidthScale())},
fitToHeight:function(){this.applyScale(this.fitToHeightScale())},fitToWidthScale:function(){return(this.containerWidth()-this.horizontalPad)/this.bookWidth()},fitToHeightScale:function(){return(this.containerHeight()-this.verticalPad)/this.bookHeight()},applyScale:function(a){this.zoomingModel.set("scale",a);this.zoomingModel.set("leftShift",this.leftShift(a));this.zoomingModel.set("topShift",this.verticalPad/2);this.render()},leftShift:function(a){return(this.containerWidth()-this.bookWidth()*a)/
2},containerWidth:function(){return this.$el.width()},containerHeight:function(){return this.$el.height()},bookWidth:function(){return this.$("#page-wrap").width()},bookHeight:function(){return this.$("#page-wrap").height()}});
Readium.Models.FixedLayoutBookZoomingModel=Backbone.Model.extend({initialize:function(){this.styleAttrs=this.getModernizedAttrs()},defaults:{scale:1,leftShift:0,topShift:0},setDefaults:function(){this.set(this.defaults)},getModernizedAttrs:function(){var a={};a.transform=this.modernizrCssPrefix("transform");a.transformOrigin=this.modernizrCssPrefix("transformOrigin");return a},modernizrCssPrefix:function(a){return Modernizr.prefixed(a).replace(/([A-Z])/g,function(a,c){return"-"+c.toLowerCase()}).replace(/^ms-/,
"-ms-")},getCSSProperties:function(){var a={};a[this.styleAttrs.transform]=this.getTransformString();a[this.styleAttrs.transformOrigin]="0 0";return a},getTransformString:function(){str="";str+="translate("+this.get("leftShift")+"px, "+this.get("topShift")+"px) ";str+="scale("+this.get("scale").toString()+")";return str}});
