!function(e){function s(a){if(t[a])return t[a].exports;var n=t[a]={i:a,l:!1,exports:{}};return e[a].call(n.exports,n,n.exports,s),n.l=!0,n.exports}var t={};s.m=e,s.c=t,s.d=function(e,t,a){s.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:a})},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,s){return Object.prototype.hasOwnProperty.call(e,s)},s.p="./",s(s.s=705)}({138:function(e,s,t){"use strict";Object.defineProperty(s,"__esModule",{value:!0});s.IGNORED_FRAME_CLASS="en-serializer-ignore",s.SERIALIZER_IGNORED_CLASS="en-serializer-ignore",s.MessageNames={FORWARD_FETCH_REQUEST:"EN_forwardFetchRequest",INSTALL_SERIALIZER:"EN_installFrameSerializer",INSTALL_AND_SERIALIZE_ALL:"EN_installAndSerializeAll",INSTALL_AND_SERIALIZE_TO:"EN_installAndSerializeTo",SERIALIZE:"EN_serialize"}},242:function(e,s,t){"use strict";Object.defineProperty(s,"__esModule",{value:!0});const a="__error__",n="EN_request",r="EN_response";s.default=class{constructor(e,s){this._channelName=e||"",this._requestHandlers=s,this._uniqueMessageID=0,this._pendingMessages={},this._handleMessage=this._handleMessage.bind(this)}start(){window.addEventListener("message",this._handleMessage)}stop(){window.removeEventListener("message",this._handleMessage)}sendMessageToFrame(e,s,t){return this.sendMessage(e.contentWindow,s,t)}sendMessageToParent(e,s){return this.sendMessage(window.parent,e,s)}sendMessage(e,s,t){return new Promise((a,r)=>{const i=`${this._channelName}-${++this._uniqueMessageID}`,l={type:n,messageID:i,name:s,data:t};this._pendingMessages[i]={name:s,resolve:a,reject:r},e.postMessage(l,"*")})}_handleMessage(e){if(e.data)switch(e.data.type){case n:return this._handleRequest(e.data,e.source);case r:return this._handleResponse(e.data)}}_handleRequest(e,s){const t=e.name,n=e.messageID,i=this._requestHandlers[t];if(!i)return;const l=i(e.data||{});Promise.resolve(l).catch(e=>({[a]:e.message})).then(e=>{const a={type:r,messageID:n,name:t,data:e};s.postMessage(a,"*")})}_handleResponse(e){const s=e.messageID,t=(e.name,this._pendingMessages[s]);if(!t)return;const n=t.resolve,r=t.reject;e.data&&e.data[a]&&r(e.data[a]),n(e.data),delete this._pendingMessages[s]}}},705:function(e,s,t){"use strict";var a=function(e){return e&&e.__esModule?e:{default:e}}(t(242)),n=t(138);const r=2e3;(new class{constructor(){this._completed=!1,this._timeoutID=null,this._frameChannel=new a.default("BrowserFrameLoader",{[n.MessageNames.INSTALL_SERIALIZER]:e=>this.installAllFrameSerializers(e),[n.MessageNames.INSTALL_AND_SERIALIZE_ALL]:e=>this.installAndSerializeAll(e),[n.MessageNames.INSTALL_AND_SERIALIZE_TO]:e=>this.installAndSerizalizeTo(e)})}start(){this._frameChannel.start()}stop(){this._frameChannel.stop()}installAndSerizalizeTo({frameName:e,resoursesPath:s=null}){const t=document.querySelector(`.${e}`);return this._frameChannel.sendMessageToFrame(t,n.MessageNames.INSTALL_SERIALIZER,s).catch(e=>{console.warn(e)}).then(()=>this._frameChannel.sendMessageToFrame(t,n.MessageNames.SERIALIZE))}installAndSerializeAll({target:e}){return this._completed=!1,new Promise(s=>{const t=()=>{this._completed||(this._completed=!0,window.clearTimeout(this._timeoutID),s(this._frameChannel.sendMessage(window,n.MessageNames.SERIALIZE,{target:e})))};this._timeoutID=window.setTimeout(()=>{t()},r),this.installAllFrameSerializers(null,e).then(()=>{t()})})}installAllFrameSerializers(e,s){return this.resoursesPath=e,Promise.all([this._installScript("FrameSerializer.js"),this._installChildFrameSerializers(s)])}_installChildFrameSerializers(e){const s=document.querySelector(e)||document;return new Promise(e=>{const t=[].slice.apply(s.querySelectorAll(`iframe:not(.${n.IGNORED_FRAME_CLASS})`));t.length||e();let a=t.length;t.forEach(s=>{this._frameChannel.sendMessageToFrame(s,n.MessageNames.INSTALL_SERIALIZER).catch().then(()=>{--a||e()})})})}_getBundleUrl(e){return"string"==typeof this.resoursesPath?`${this.resoursesPath}${e}`:chrome.runtime.getURL(e)}_installScript(e){return new Promise((s,t)=>{const a=this._getBundleUrl(e);if(document.querySelector(`script[src='${a}']`))return void s();let n=document.createElement("script");n.type="text/javascript",n.src=a,n.onload=(()=>{s()}),n.onerror=(()=>{t(new Error(`Failed to load script: "${a}"`))}),document.head.appendChild(n)})}}).start()}});